import{domQuery}from"../../util";import"./slider.scss";export const Slider=()=>{const e=domQuery(".levels"),t=domQuery(".progress"),n=domQuery(".knob");let o,i,s,l,r=0,d=0,a=e.querySelectorAll(".level"),c=a[0].getBoundingClientRect().width+a[1].getBoundingClientRect().width-10;window.addEventListener("resize",(()=>{a=e.querySelectorAll(".level"),console.log("resize",a[0].getBoundingClientRect().width),c=a[0].getBoundingClientRect().width+a[1].getBoundingClientRect().width-10,n.style.transform=`translateX(${c}px) rotate(-45deg)`})),n.style.transform=`translateX(${c}px) rotate(-45deg)`;let u=0;function g(e){const{type:s}=e;console.log(s);var a=0;if("mousemove"===s)a=e.x<r?r:e.x>d?d:e.x;else if("touchmove"===s){let t=e.changedTouches[0].clientX;a=t<r?r:t>d?d:t}u=a-l-o.left,console.log("dragging",o.left,"shift",l,"x",a),console.log(u),n.style.transform=`translateX(${u}px) rotate(-45deg)`,t.style.width=u+i.width/2+"px"}function w(e){var o,l=(o=u,s.reduce(((e,t)=>Math.abs(t-o)<Math.abs(e-o)?t:e)));n.style.transition="0.5s",t.style.transition="0.5s",n.style.transform=`\n    translateX(${l-i.width/2.7}px)\n    rotate(-45deg)\n `,t.style.width=l+"px",window.removeEventListener("mousemove",g),window.removeEventListener("mousemove",w)}function h(){o=e.getBoundingClientRect(),i=n.getBoundingClientRect(),console.log("init",o),s=[0,.2*o.width,.45*o.width,o.width],r=o.left,d=o.right}n.addEventListener("touchstart",(function(e){e.preventDefault(),window.addEventListener("touchmove",g),window.addEventListener("touchend",w),n.style.transition="0s",t.style.transition="0s";const o=n.getBoundingClientRect();console.log(e),l=e.changedTouches[0].clientX-o.left,console.log("shift",l),window.onresize=h,h()})),n.addEventListener("mousedown",(function(e){e.preventDefault(),window.addEventListener("mousemove",g),window.addEventListener("mouseup",w),n.style.transition="0s",t.style.transition="0s";const o=n.getBoundingClientRect();l=e.x-o.left,window.onresize=h,h()}))};